CREATE DATABASE SalesPerformanceDB;
USE SalesPerformanceDB;
-- Desgin the schema 4 main tables: Products, Customers, SalesRepresentatives, and Sales--
CREATE TABLE Products (
product_id int auto_increment primary key,
product_name varchar(255),
category VARCHAR(100),
price DECIMAL(10,2)
); 
CREATE TABLE Customers (
customer_id INT AUTO_INCREMENT PRIMARY KEY,
customer_name VARCHAR(255),
contact_info VARCHAR(255),
region VARCHAR(100)
);
CREATE TABLE SalesRepresentatives (
sales_rep_id INT AUTO_INCREMENT PRIMARY KEY,
rep_name varchar(255),
territory Varchar(100)
);
CREATE TABLE Sales (
sale_id int auto_increment primary key,
sale_date DATE,
product_id INT,
customer_id int,
sales_rep_id int,
quantity int,
total_amount decimal(10,2),
FOREIGN KEY (product_id) REFERENCES Products(product_id),
FOREIGN KEY (customer_id) REFERENCES Customers(customer_id),
FOREIGN KEY (sales_rep_id) REFERENCES SalesRepresentatives (sales_rep_id)
);
-- populate the database with sample data--
INSERT INTO Products (product_name, category, price) VALUES
('Laptop', 'Electronics', 799.99),
('Smartphone', 'Electronics', 499.99),
('Tablet', 'Electronics', 299.99),
('Smartwatch', 'Wearables', 199.99),
('Headphones', 'Accessories', 99.99),
('Monitor', 'Electronics', 149.99),
('Keyboard', 'Accessories', 49.99),
('Mouse', 'Accessories', 29.99),
('Printer', 'Office Supplies', 89.99),
('Desk Lamp', 'Office Supplies', 39.99);


INSERT INTO Customers (customer_name, contact_info, region) VALUES
('John Doe', 'john.doe@example.com', 'North'),
('Jane Smith', 'jane.smith@example.com', 'South'),
('Michael Johnson', 'michael.johnson@example.com', 'East'),
('Emily Davis', 'emily.davis@example.com', 'West'),
('Chris Brown', 'chris.brown@example.com', 'North'),
('Patricia Wilson', 'patricia.wilson@example.com', 'South'),
('Robert Martinez', 'robert.martinez@example.com', 'East'),
('Linda Anderson', 'linda.anderson@example.com', 'West'),
('David Thomas', 'david.thomas@example.com', 'North'),
('Sarah Lee', 'sarah.lee@example.com', 'South'),
('James Rodriguez', 'james.rodriguez@example.com', 'East'),
('Mary Lewis', 'mary.lewis@example.com', 'West'),
('Joseph Walker', 'joseph.walker@example.com', 'North'),
('Jennifer Hall', 'jennifer.hall@example.com', 'South'),
('Daniel Allen', 'daniel.allen@example.com', 'East'),
('Barbara Young', 'barbara.young@example.com', 'West'),
('Matthew King', 'matthew.king@example.com', 'North'),
('Susan Wright', 'susan.wright@example.com', 'South'),
('Anthony Scott', 'anthony.scott@example.com', 'East'),
('Karen Green', 'karen.green@example.com', 'West'),
('William Harris', 'william.harris@example.com', 'North'),
('Nancy Nelson', 'nancy.nelson@example.com', 'South'),
('Richard Clark', 'richard.clark@example.com', 'East'),
('Laura Adams', 'laura.adams@example.com', 'West'),
('Charles Baker', 'charles.baker@example.com', 'North'),
('Betty Gonzalez', 'betty.gonzalez@example.com', 'South'),
('Thomas Perez', 'thomas.perez@example.com', 'East'),
('Margaret Roberts', 'margaret.roberts@example.com', 'West'),
('Paul Turner', 'paul.turner@example.com', 'North'),
('Dorothy Phillips', 'dorothy.phillips@example.com', 'South'),
('Mark Campbell', 'mark.campbell@example.com', 'East'),
('Sandra Parker', 'sandra.parker@example.com', 'West'),
('Steven Evans', 'steven.evans@example.com', 'North'),
('Carol Edwards', 'carol.edwards@example.com', 'South'),
('Andrew Collins', 'andrew.collins@example.com', 'East'),
('Jessica Stewart', 'jessica.stewart@example.com', 'West'),
('Joshua Sanchez', 'joshua.sanchez@example.com', 'North'),
('Rebecca Morris', 'rebecca.morris@example.com', 'South'),
('Kevin Rogers', 'kevin.rogers@example.com', 'East'),
('Shirley Reed', 'shirley.reed@example.com', 'West'),
('Brian Cook', 'brian.cook@example.com', 'North'),
('Amanda Morgan', 'amanda.morgan@example.com', 'South'),
('George Bell', 'george.bell@example.com', 'East'),
('Melissa Murphy', 'melissa.murphy@example.com', 'West'),
('Edward Bailey', 'edward.bailey@example.com', 'North'),
('Stephanie Rivera', 'stephanie.rivera@example.com', 'South'),
('Ronald Cooper', 'ronald.cooper@example.com', 'East'),
('Laura Richardson', 'laura.richardson@example.com', 'West'),
('Kenneth Cox', 'kenneth.cox@example.com', 'North'),
('Angela Howard', 'angela.howard@example.com', 'South'),
('Jason Ward', 'jason.ward@example.com', 'East'),
('Lisa Torres', 'lisa.torres@example.com', 'West'),
('Ryan Peterson', 'ryan.peterson@example.com', 'North'),
('Sharon Gray', 'sharon.gray@example.com', 'South'),
('Jeffrey Ramirez', 'jeffrey.ramirez@example.com', 'East'),
('Michelle James', 'michelle.james@example.com', 'West'),
('Frank Watson', 'frank.watson@example.com', 'North'),
('Deborah Brooks', 'deborah.brooks@example.com', 'South'),
('Scott Kelly', 'scott.kelly@example.com', 'East'),
('Cynthia Sanders', 'cynthia.sanders@example.com', 'West'),
('Eric Price', 'eric.price@example.com', 'North'),
('Kathleen Bennett', 'kathleen.bennett@example.com', 'South'),
('Stephen Wood', 'stephen.wood@example.com', 'East'),
('Martha Barnes', 'martha.barnes@example.com', 'West'),
('Larry Ross', 'larry.ross@example.com', 'North'),
('Anna Henderson', 'anna.henderson@example.com', 'South'),
('Justin Coleman', 'justin.coleman@example.com', 'East'),
('Frances Powell', 'frances.powell@example.com', 'West'),
('Brandon Long', 'brandon.long@example.com', 'North'),
('Joan Patterson', 'joan.patterson@example.com', 'South'),
('Gary Hughes', 'gary.hughes@example.com', 'East'),
('Alice Flores', 'alice.flores@example.com', 'West'),
('Nicholas Washington', 'nicholas.washington@example.com', 'North'),
('Teresa Butler', 'teresa.butler@example.com', 'South'),
('Jonathan Simmons', 'jonathan.simmons@example.com', 'East'),
('Dorothy Foster', 'dorothy.foster@example.com', 'West'),
('Jacob Gonzales', 'jacob.gonzales@example.com', 'North'),
('Victoria Bryant', 'victoria.bryant@example.com', 'South'),
('Raymond Alexander', 'raymond.alexander@example.com', 'East'),
('Christine Russell', 'christine.russell@example.com', 'West'),
('Patrick Griffin', 'patrick.griffin@example.com', 'North'),
('Marie Diaz', 'marie.diaz@example.com', 'South'),
('Jack Hayes', 'jack.hayes@example.com', 'East'),
('Ann Perry', 'ann.perry@example.com', 'West'),
('Dennis Myers', 'dennis.myers@example.com', 'North'),
('Sara Ford', 'sara.ford@example.com', 'South'),
('Jerry Hamilton', 'jerry.hamilton@example.com', 'East'),
('Megan Graham', 'megan.graham@example.com', 'West'),
('Alexander Sullivan', 'alexander.sullivan@example.com', 'North'),
('Gloria Wallace', 'gloria.wallace@example.com', 'South'),
('Henry Woods', 'henry.woods@example.com', 'East'),
('Emma West', 'emma.west@example.com', 'West'),
('Carl Cole', 'carl.cole@example.com', 'North'),
('Heather Sanders', 'heather.sanders@example.com', 'South'),
('Ralph Bryant', 'ralph.bryant@example.com', 'East'),
('Diane Lawson', 'diane.lawson@example.com', 'West');

INSERT INTO SalesRepresentatives (rep_name, territory) VALUES
('John Doe', 'North'),
('Jane Smith', 'South'),
('Michael Johnson', 'East'),
('Emily Davis', 'West'),
('Chris Brown', 'North'),
('Patricia Wilson', 'South'),
('Robert Martinez', 'East'),
('Linda Anderson', 'West'),
('David Thomas', 'North'),
('Sarah Lee', 'South'),
('James Rodriguez', 'East'),
('Mary Lewis', 'West'),
('Joseph Walker', 'North'),
('Jennifer Hall', 'South'),
('Daniel Allen', 'East'),
('Barbara Young', 'West'),
('Matthew King', 'North'),
('Susan Wright', 'South'),
('Anthony Scott', 'East'),
('Karen Green', 'West'),
('William Harris', 'North'),
('Nancy Nelson', 'South'),
('Richard Clark', 'East'),
('Laura Adams', 'West'),
('Charles Baker', 'North'),
('Betty Gonzalez', 'South'),
('Thomas Perez', 'East'),
('Margaret Roberts', 'West'),
('Paul Turner', 'North'),
('Dorothy Phillips', 'South'),
('Mark Campbell', 'East'),
('Sandra Parker', 'West'),
('Steven Evans', 'North'),
('Carol Edwards', 'South'),
('Andrew Collins', 'East'),
('Jessica Stewart', 'West'),
('Joshua Sanchez', 'North'),
('Rebecca Morris', 'South'),
('Kevin Rogers', 'East'),
('Shirley Reed', 'West'),
('Brian Cook', 'North'),
('Amanda Morgan', 'South'),
('George Bell', 'East'),
('Melissa Murphy', 'West'),
('Edward Bailey', 'North'),
('Stephanie Rivera', 'South'),
('Ronald Cooper', 'East'),
('Laura Richardson', 'West'),
('Kenneth Cox', 'North'),
('Angela Howard', 'South'),
('Jason Ward', 'East'),
('Lisa Torres', 'West'),
('Ryan Peterson', 'North'),
('Sharon Gray', 'South'),
('Jeffrey Ramirez', 'East'),
('Michelle James', 'West'),
('Frank Watson', 'North'),
('Deborah Brooks', 'South'),
('Scott Kelly', 'East'),
('Cynthia Sanders', 'West'),
('Eric Price', 'North'),
('Kathleen Bennett', 'South'),
('Stephen Wood', 'East'),
('Martha Barnes', 'West'),
('Larry Ross', 'North'),
('Anna Henderson', 'South'),
('Justin Coleman', 'East'),
('Frances Powell', 'West'),
('Brandon Long', 'North'),
('Joan Patterson', 'South'),
('Gary Hughes', 'East'),
('Alice Flores', 'West'),
('Nicholas Washington', 'North'),
('Teresa Butler', 'South'),
('Jonathan Simmons', 'East'),
('Dorothy Foster', 'West'),
('Jacob Gonzales', 'North'),
('Victoria Bryant', 'South'),
('Raymond Alexander', 'East'),
('Christine Russell', 'West'),
('Patrick Griffin', 'North'),
('Marie Diaz', 'South'),
('Jack Hayes', 'East'),
('Ann Perry', 'West'),
('Dennis Myers', 'North'),
('Sara Ford', 'South'),
('Jerry Hamilton', 'East'),
('Megan Graham', 'West'),
('Alexander Sullivan', 'North'),
('Gloria Wallace', 'South'),
('Henry Woods', 'East'),
('Emma West', 'West'),
('Carl Cole', 'North'),
('Heather Sanders', 'South'),
('Ralph Bryant', 'East'),
('Diane Lawson', 'West'),
('Martin Rivera', 'North'),
('Rose Cooper', 'South'),
('Bruce White', 'East'),
('Diana Murphy', 'West'),
('Arthur Foster', 'North'),
('Sophia Mitchell', 'South'),
('Harry Harris', 'East'),
('Olivia Hughes', 'West'),
('Ethan Hall', 'North'),
('Grace Baker', 'South'),
('Sam Martinez', 'East'),
('Victoria Perez', 'West');
-- Analyze Data and Create Reports--
-- a view showing total sales per product--
CREATE VIEW SalesPerProduct AS
SELECT 
    p.product_name, 
    SUM(s.total_amount) AS total_sales
FROM Sales s
JOIN Products p ON s.product_id = p.product_id
GROUP BY p.product_name;
-- complex queries 'total revenue by region'--
 SELECT 
    c.region, 
    SUM(s.total_amount) AS total_revenue
FROM Sales s
JOIN Customers c ON s.customer_id = c.customer_id
GROUP BY c.region;

-- Ensure the Sales table exists
CREATE TABLE IF NOT EXISTS Sales (
    sale_id INT AUTO_INCREMENT PRIMARY KEY,
    customer_id INT,
    sales_rep_id INT,
    product_id INT,
    sale_date DATE,
    quantity INT,
    total_amount DECIMAL(10, 2),
    FOREIGN KEY (customer_id) REFERENCES Customers(customer_id),
    FOREIGN KEY (sales_rep_id) REFERENCES SalesRepresentatives(rep_id),
    FOREIGN KEY (product_id) REFERENCES Products(product_id)
);


INSERT INTO Sales (sale_id, sale_date, product_id, customer_id, sales_rep_id, quantity, total_amount) VALUES
(1, '2024-01-01', 1, 1, 1, 5, 100.00),
(2, '2024-01-02', 2, 2, 2, 3, 60.00),
(3, '2024-01-03', 3, 3, 3, 7, 140.00),
(4, '2024-01-04', 4, 4, 4, 2, 40.00),
(5, '2024-01-05', 5, 5, 5, 6, 120.00),
(6, '2024-01-06', 6, 6, 6, 4, 80.00),
(7, '2024-01-07', 7, 7, 7, 5, 100.00),
(8, '2024-01-08', 8, 8, 8, 3, 60.00),
(9, '2024-01-09', 9, 9, 9, 7, 140.00),
(10, '2024-01-10', 10, 10, 10, 2, 40.00),
(11, '2024-01-11', 1, 11, 1, 4, 80.00),
(12, '2024-01-12', 2, 12, 2, 8, 160.00),
(13, '2024-01-13', 3, 13, 3, 6, 120.00),
(14, '2024-01-14', 4, 14, 4, 5, 100.00),
(15, '2024-01-15', 5, 15, 5, 3, 60.00),
(16, '2024-01-16', 6, 16, 6, 7, 140.00),
(17, '2024-01-17', 7, 17, 7, 2, 40.00),
(18, '2024-01-18', 8, 18, 8, 9, 180.00),
(19, '2024-01-19', 9, 19, 9, 4, 80.00),
(20, '2024-01-20', 10, 20, 10, 6, 120.00),
(21, '2024-01-21', 1, 21, 1, 3, 60.00),
(22, '2024-01-22', 2, 22, 2, 5, 100.00),
(23, '2024-01-23', 3, 23, 3, 7, 140.00),
(24, '2024-01-24', 4, 24, 4, 4, 80.00),
(25, '2024-01-25', 5, 25, 5, 2, 40.00),
(26, '2024-01-26', 6, 26, 6, 6, 120.00),
(27, '2024-01-27', 7, 27, 7, 3, 60.00),
(28, '2024-01-28', 8, 28, 8, 7, 140.00),
(29, '2024-01-29', 9, 29, 9, 2, 40.00),
(30, '2024-01-30', 10, 30, 10, 5, 100.00),
(31, '2024-02-01', 1, 31, 1, 4, 80.00),
(32, '2024-02-02', 2, 32, 2, 8, 160.00),
(33, '2024-02-03', 3, 33, 3, 5, 100.00),
(34, '2024-02-04', 4, 34, 4, 6, 120.00),
(35, '2024-02-05', 5, 35, 5, 3, 60.00),
(36, '2024-02-06', 6, 36, 6, 7, 140.00),
(37, '2024-02-07', 7, 37, 7, 2, 40.00),
(38, '2024-02-08', 8, 38, 8, 9, 180.00),
(39, '2024-02-09', 9, 39, 9, 4, 80.00),
(40, '2024-02-10', 10, 40, 10, 6, 120.00),
(41, '2024-02-11', 1, 41, 1, 3, 60.00),
(42, '2024-02-12', 2, 42, 2, 7, 140.00),
(43, '2024-02-13', 3, 43, 3, 5, 100.00),
(44, '2024-02-14', 4, 44, 4, 6, 120.00),
(45, '2024-02-15', 5, 45, 5, 4, 80.00),
(46, '2024-02-16', 6, 46, 6, 2, 40.00),
(47, '2024-02-17', 7, 47, 7, 6, 120.00),
(48, '2024-02-18', 8, 48, 8, 5, 100.00),
(49, '2024-02-19', 9, 49, 9, 9, 180.00),
(50, '2024-02-20', 10, 50, 10, 3, 60.00),
(51, '2024-03-01', 1, 51, 1, 8, 160.00),
(52, '2024-03-02', 2, 52, 2, 6, 120.00),
(53, '2024-03-03', 3, 53, 3, 5, 100.00),
(54, '2024-03-04', 4, 54, 4, 7, 140.00),
(55, '2024-03-05', 5, 55, 5, 2, 40.00),
(56, '2024-03-06', 6, 56, 6, 9, 180.00),
(57, '2024-03-07', 7, 57, 7, 4, 80.00),
(58, '2024-03-08', 8, 58, 8, 6, 120.00),
(59, '2024-03-09', 9, 59, 9, 3, 60.00),
(60, '2024-03-10', 10, 60, 10, 7, 140.00),
(61, '2024-03-11', 1, 61, 1, 5, 100.00),
(62, '2024-03-12', 2, 62, 2, 8, 160.00),
(63, '2024-03-13', 3, 63, 3, 4, 80.00),
(64, '2024-03-14', 4, 64, 4, 6, 120.00),
(65, '2024-03-15', 5, 65, 5, 3, 60.00),
(66, '2024-03-16', 6, 66, 6, 9, 180.00),
(67, '2024-03-17', 7, 67, 7, 5, 100.00),
(68, '2024-03-18', 8, 68, 8, 8, 160.00),
(69, '2024-03-19', 9, 69, 9, 6, 120.00),
(70, '2024-03-20', 10, 70, 10, 7, 140.00),
(71, '2024-03-21', 1, 71, 1, 4, 80.00),
(72, '2024-03-22', 2, 72, 2, 8, 160.00),
(73, '2024-03-23', 3, 73, 3, 5, 100.00),
(74, '2024-03-24', 4, 74, 4, 6, 120.00),
(75, '2024-03-25', 5, 75, 5, 2, 40.00),
(76, '2024-03-26', 6, 76, 6, 7, 140.00),
(77, '2024-03-27', 7, 77, 7, 3, 60.00),
(78, '2024-03-28', 8, 78, 8, 5, 100.00),
(79, '2024-03-29', 9, 79, 9, 4, 80.00),
(80, '2024-03-30', 10, 80, 10, 7, 140.00),
(81, '2024-04-01', 1, 81, 1, 6, 120.00),
(82, '2024-04-02', 2, 82, 2, 5, 100.00),
(83, '2024-04-03', 3, 83, 3, 7, 140.00),
(84, '2024-04-04', 4, 84, 4, 2, 40.00),
(85, '2024-04-05', 5, 85, 5, 8, 160.00),
(86, '2024-04-06', 6, 86, 6, 9, 180.00),
(87, '2024-04-07', 7, 87, 7, 3, 60.00),
(88, '2024-04-08', 8, 88, 8, 7, 140.00),
(89, '2024-04-09', 9, 89, 9, 4, 80.00),
(90, '2024-04-10', 10, 90, 10, 6, 120.00),
(91, '2024-04-11', 1, 91, 1, 5, 100.00),
(92, '2024-04-12', 2, 92, 2, 6, 120.00),
(93, '2024-04-13', 3, 93, 3, 7, 140.00),
(94, '2024-04-14', 4, 94, 4, 8, 160.00),
(95, '2024-04-15', 5, 95, 5, 9, 180.00),
(96, '2024-04-16', 6, 1, 6, 2, 40.00),
(97, '2024-04-17', 7, 2, 7, 3, 60.00),
(98, '2024-04-18', 8, 3, 8, 4, 80.00),
(99, '2024-04-19', 9, 4, 9, 5, 100.00),
(100, '2024-04-20', 10, 5, 10, 6, 120.00),
(101, '2024-04-21', 1, 6, 1, 7, 140.00),
(102, '2024-04-22', 2, 7, 2, 8, 160.00),
(103, '2024-04-23', 3, 8, 3, 9, 180.00),
(104, '2024-04-24', 4, 9, 4, 2, 40.00),
(105, '2024-04-25', 5, 10, 5, 3, 60.00),
(106, '2024-04-26', 6, 1, 6, 4, 80.00),
(107, '2024-04-27', 7, 2, 7, 5, 100.00),
(108, '2024-04-28', 8, 3, 8, 6, 120.00),
(109, '2024-04-29', 9, 4, 9, 7, 140.00),
(110, '2024-04-30', 10, 5, 10, 8, 160.00);





